apiVersion: automation.cloudbees.io/v1alpha1
kind: workflow
name: test
on:
  workflow_dispatch:
jobs:
  db-schema:
    uses: shozab-unify-examples/sn-database-deploy/.cloudbees/reusable-workflows/db-schema.yml
    with:
      version: "v2.0.1"

  deploy-app:
    uses: shozab-unify-examples/sn-database-deploy/.cloudbees/reusable-workflows/deploy-app.yml
    needs:
      - db-schema
    with:
      artifact-id: ${{ needs.db-schema.outputs.artifact-id }} 
      environment: "prod"

  rollback:
    uses: shozab-unify-examples/sn-database-deploy/.cloudbees/reusable-workflows/rollback.yml
    needs:
      - deploy-app
